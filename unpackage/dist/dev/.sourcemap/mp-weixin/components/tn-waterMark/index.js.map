{"version":3,"sources":["webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?1cbe","webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?730e","webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?1113","webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?992b","uni-app:///components/tn-waterMark/index.vue","webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?68e2","webpack:///E:/companyCode/booked-weapp/components/tn-waterMark/index.vue?e55f"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AAC0N;AAC1N,gBAAgB,gOAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAw2B,CAAgB,82BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACS53B;AACA,WADA;;;AAIA,MAJA,kBAIA;AACA;AACA,cADA;AAEA,mBAFA;AAGA,2BAHA;AAIA,qBAJA;AAKA,sBALA;AAMA,mBANA;AAOA,cAPA;;AASA,GAdA;AAeA,SAfA,qBAeA;AACA;;;;AAIA;AACA;AACA;AACA,OAHA;;AAKA,GAzBA;AA0BA;AACA,gBADA,wBACA,OADA,EACA,IADA,EACA,EADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAVA;AAWA,oBAXA,4BAWA,OAXA,EAWA;AACA;AACA;AACA,wBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA;AACA;AACA,aARA,MAQA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAlBA,MAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA,SA9BA;;AAgCA,KA7CA;AA8CA,mBA9CA,2BA8CA,OA9CA,EA8CA,GA9CA,EA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAPA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAPA,CAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAdA,MAcA;AACA;AACA;AACA;AACA;AACA,OA9BA;AA+BA;AACA;AACA;AACA,0BADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAdA,MAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aA9BA;;AAgCA,SAjCA;AAkCA,OAnCA,MAmCA;AACA;AACA;AACA,KAnIA;AAoIA,uBApIA,+BAoIA,OApIA,EAoIA,GApIA,EAoIA;AACA;AACA;AACA;AACA,8BADA,EACA;AACA,uCAFA;AAGA,kBAHA,oBAGA,GAHA,EAGA;;AAEA;AACA;;;;;;;;;;;;AAYA,WAlBA;AAmBA,aAnBA;AAoBA,OArBA;AAsBA,KA5JA;AA6JA,gBA7JA,wBA6JA,OA7JA,EA6JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WANA,MAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAdA,MAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAPA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAPA,CAOA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAdA,MAcA;AACA;AACA;AACA;AACA;AACA,SA/BA;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAdA,MAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aA9BA;AA+BA,WAnCA;AAoCA,SArCA,MAqCA;AACA;AACA;AACA;AACA;AACA,OAhHA;AAiHA,KAnRA,EA1BA,E;;;;;;;;;;;;;ACTA;AAAA;AAAA;AAAA;AAA+nD,CAAgB,ikDAAG,EAAC,C;;;;;;;;;;;ACAnpD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/tn-waterMark/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=cf1b06a2&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=cf1b06a2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cf1b06a2\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/tn-waterMark/index.vue\"\nexport default component.exports","export * from \"-!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=cf1b06a2&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view v-for=\"item in canvasArr\">\r\n\t\t\t<canvas canvas-id=\"myCanvas\" :style=\"{width:canvasWidth+'px',height:canvasHeight+'px'}\"></canvas>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tprops: {\r\n\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttype:'',\r\n\t\t\t\tcanvasArr: [],\r\n\t\t\t\tplatformType: 'other',\r\n\t\t\t\tcanvasWidth: '',\r\n\t\t\t\tcanvasHeight: '',\r\n\t\t\t\tpixelRatio: 1,\r\n\t\t\t\tfn:null,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tlet _this = this;\r\n\t\t\t// #ifdef H5\r\n\t\t\t_this.platformType = 'h5';\r\n\t\t\t// #endif\r\n\t\t\twx.getSystemInfo({\r\n\t\t\t\tsuccess: function(data) {console.log(data);\r\n\t\t\t\t\t_this.pixelRatio = data.pixelRatio;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\taddWaterMark(options,type,fn) {\r\n\t\t\t\tthis.fn = fn;\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tthis.type = type;\r\n\t\t\t\tif (_this.platformType == 'h5') {\r\n\t\t\t\t\t_this.h5CanvasDraw(options);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_this.otherCanvasReady(options);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\totherCanvasReady(options) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\tsrc: options.url,\r\n\t\t\t\t\tsuccess: function(img) {\r\n\t\t\t\t\t\tlet size = options.maxSize || 0;\r\n\t\t\t\t\t\tif (options.maxSize) {\r\n\t\t\t\t\t\t\tif (img.width > img.height) {\r\n\t\t\t\t\t\t\t\tif (img.width < size) {\r\n\t\t\t\t\t\t\t\t\tsize = img.width / _this.pixelRatio;\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tsize = size / _this.pixelRatio\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_this.canvasWidth = size;\r\n\t\t\t\t\t\t\t\t_this.canvasHeight = img.height / (img.width / size);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (img.height < size) {\r\n\t\t\t\t\t\t\t\t\tsize = img.height / _this.pixelRatio;\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tsize = size / _this.pixelRatio\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_this.canvasHeight = size;\r\n\t\t\t\t\t\t\t\t_this.canvasWidth = img.width / (img.height / size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.canvasWidth = img.width / _this.pixelRatio\r\n\t\t\t\t\t\t\t_this.canvasHeight = img.height / _this.pixelRatio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.canvasArr.splice(0, 1, 1);\r\n\t\t\t\t\t\t_this.$nextTick(function() {\r\n\t\t\t\t\t\t\t_this.otherCanvasDraw(options, img);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\totherCanvasDraw(options, img) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tconst ctx = uni.createCanvasContext('myCanvas',_this)\r\n\t\t\t\tctx.drawImage(img.path, 0, 0, _this.canvasWidth, _this.canvasHeight)\r\n\t\t\t\tctx.textAlign = options.textAlign || 'top'\r\n\t\t\t\tctx.textBaseline = options.textBaseline || 'top'\r\n\t\t\t\tlet imageArr = [];\r\n\t\t\t\tlet textArr = [];\r\n\t\t\t\toptions.watermark.some(function(item, index) {\r\n\t\t\t\t\tif (item.type == 'image') {\r\n\t\t\t\t\t\timageArr.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.type == 'text') {\r\n\t\t\t\t\t\ttextArr.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\ttextArr.some(function(item, index) {\r\n\t\t\t\t\tctx.font = (item.font||'16px') + ' Arial'\r\n\t\t\t\t\tctx.shadowColor = item.shadowColor||'#000'\r\n\t\t\t\t\tctx.shadowOffsetX = item.shadowOffsetX||0;\r\n\t\t\t\t\tctx.shadowOffsetY = item.shadowOffsetY||0;\r\n\t\t\t\t\tctx.fillStyle = item.fillStyle||'#fff'\r\n\t\t\t\t\tctx.globalAlpha = item.globalAlpha || 1;\r\n\t\t\t\t\tconst fontWidth = ctx.measureText(item.content).width / 2; //获取文本宽度\r\n\t\t\t\t\tlet rotate = item.rotate||0\r\n\t\t\t\t\titem.x = item.x||0\r\n\t\t\t\t\titem.y = item.y||0\r\n\t\t\t\t\tif(item.isRepeat){\r\n\t\t\t\t\t\titem.repeatWidth = item.repeatWidth||_this.canvasWidth\r\n\t\t\t\t\t\titem.repeatHeight = item.repeatHeight||_this.canvasHeight\r\n\t\t\t\t\t\titem.distanceX = item.distanceX||100\r\n\t\t\t\t\t\titem.distanceY = item.distanceY||50\r\n\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\tfor(let i = item.x; i<item.repeatWidth; i+=item.distanceX) {\r\n\t\t\t\t\t\t\tfor(let j = item.y; j<item.repeatHeight; j+=item.distanceY) {\r\n\t\t\t\t\t\t\t  // 填充文字，x 间距, y 间距\r\n\t\t\t\t\t\t\t  console.log(item.x,item.y);\r\n\t\t\t\t\t\t\t  ctx.fillText(item.content, i, j)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\tctx.fillText(item.content, item.x, item.y);\r\n\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tif(imageArr.length){\r\n\t\t\t\t\timageArr.some(function(item, index) {\r\n\t\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\t\tsrc: item.path,\r\n\t\t\t\t\t\t\tsuccess: function(reimg) {\r\n\t\t\t\t\t\t\t\tlet rotate = item.rotate||0\r\n\t\t\t\t\t\t\t\titem.x = item.x||0\r\n\t\t\t\t\t\t\t\titem.y = item.y||0\r\n\t\t\t\t\t\t\t\titem.width = item.width||reimg.width / _this.pixelRatio\r\n\t\t\t\t\t\t\t\titem.height = item.height||reimg.height / _this.pixelRatio\r\n\t\t\t\t\t\t\t\tif(item.isRepeat){\r\n\t\t\t\t\t\t\t\t\titem.repeatWidth = item.repeatWidth||_this.canvasWidth\r\n\t\t\t\t\t\t\t\t\titem.repeatHeight = item.repeatHeight||_this.canvasHeight\r\n\t\t\t\t\t\t\t\t\titem.distanceX = item.distanceX||100\r\n\t\t\t\t\t\t\t\t\titem.distanceY = item.distanceY||50\r\n\t\t\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\tfor(let i = item.x; i<item.repeatWidth; i+=item.distanceX) {\r\n\t\t\t\t\t\t\t\t\t\tfor(let j = item.y; j<item.repeatHeight; j+=item.distanceY) {\r\n\t\t\t\t\t\t\t\t\t\t  // 填充文字，x 间距, y 间距\r\n\t\t\t\t\t\t\t\t\t\t  console.log(item.x,item.y);\r\n\t\t\t\t\t\t\t\t\t\t  ctx.drawImage(reimg.path, i, j, item.width, item.height)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\t\t\tctx.drawImage(reimg.path, item.x, item.y, item.width, item.height)\r\n\t\t\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (imageArr.length == index + 1 || textArr.length == index + 1) {\r\n\t\t\t\t\t\t\t\t\t_this.otherGenerateBase64(options, ctx);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\t_this.otherGenerateBase64(options, ctx);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\totherGenerateBase64(options, ctx) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tctx.draw(true, function(ret) {\r\n\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\tcanvasId: 'myCanvas', // canvas id\r\n\t\t\t\t\t\tquality: options.quality || 1,\r\n\t\t\t\t\t\tcomplete(res) {\r\n\t\t\t\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\t\t\t_this.$emit(\"pBackImage\",res.tempFilePath,_this.type);\r\n\t\t\t\t\t\t\t_this.fn(res.tempFilePath,_this.type)\r\n\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\t\t\t\tconst savedFilePath = res.tempFilePath //相对路径\r\n\t\t\t\t\t\t\tconst path = plus.io.convertLocalFileSystemURL(savedFilePath) //绝对路径\r\n\t\t\t\t\t\t\tconst fileReader = new plus.io.FileReader()\r\n\t\t\t\t\t\t\tfileReader.readAsDataURL(path)\r\n\t\t\t\t\t\t\tfileReader.onloadend = (res) => { //读取文件成功完成的回调函数\r\n\t\t\t\t\t\t\t\t_this.$emit(\"pBackImage\",res.target.result,_this.type);\r\n\t\t\t\t\t\t\t\t_this.fn(res.target.result,_this.type)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},_this)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\th5CanvasDraw(options) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tconst img = new Image()\r\n\t\t\t\timg.src = options.url\r\n\t\t\t\timg.crossOrigin = 'anonymous'\r\n\t\t\t\timg.onload = function() {\r\n\t\t\t\t\tconst canvas = document.createElement('canvas')\r\n\t\t\t\t\tlet size = options.maxSize || 0;\r\n\t\t\t\t\tif (options.maxSize) {\r\n\t\t\t\t\t\tif (img.width > img.height) {\r\n\t\t\t\t\t\t\tif (img.width < size) {\r\n\t\t\t\t\t\t\t\tsize = img.width;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this.canvasWidth = size;\r\n\t\t\t\t\t\t\t_this.canvasHeight = img.height / (img.width / size);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (img.height < size) {\r\n\t\t\t\t\t\t\t\tsize = img.height;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this.canvasHeight = size;\r\n\t\t\t\t\t\t\t_this.canvasWidth = img.width / (img.height / size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_this.canvasWidth = img.width\r\n\t\t\t\t\t\t_this.canvasHeight = img.height\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcanvas.width = _this.canvasWidth\r\n\t\t\t\t\tcanvas.height = _this.canvasHeight\r\n\t\t\t\t\tconst ctx = canvas.getContext('2d')\r\n\t\t\t\t\tctx.drawImage(img, 0, 0)\r\n\t\t\t\t\tctx.textAlign = options.textAlign || 'top'\r\n\t\t\t\t\tctx.textBaseline = options.textBaseline || 'top'\r\n\r\n\t\t\t\t\tlet imageArr = [];\r\n\t\t\t\t\tlet textArr = [];\r\n\t\t\t\t\toptions.watermark.some(function(item, index) {\r\n\t\t\t\t\t\tif (item.type == 'image') {\r\n\t\t\t\t\t\t\timageArr.push(item);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (item.type == 'text') {\r\n\t\t\t\t\t\t\ttextArr.push(item);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\ttextArr.some(function(item, index) {\r\n\t\t\t\t\t\tctx.font = (item.font||'16px') + ' Arial'\r\n\t\t\t\t\t\tctx.shadowColor = item.shadowColor||'#000'\r\n\t\t\t\t\t\tctx.shadowOffsetX = item.shadowOffsetX||0;\r\n\t\t\t\t\t\tctx.shadowOffsetY = item.shadowOffsetY||0;\r\n\t\t\t\t\t\tctx.fillStyle = item.fillStyle||'#fff'\r\n\t\t\t\t\t\tctx.globalAlpha = item.globalAlpha || 1;\r\n\t\t\t\t\t\tconst fontWidth = ctx.measureText(item.content).width / 2; //获取文本宽度\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet rotate = item.rotate||0\r\n\t\t\t\t\t\titem.x = item.x||0\r\n\t\t\t\t\t\titem.y = item.y||0\r\n\t\t\t\t\t\tif(item.isRepeat){\r\n\t\t\t\t\t\t\titem.repeatWidth = item.repeatWidth||_this.canvasWidth\r\n\t\t\t\t\t\t\titem.repeatHeight = item.repeatHeight||_this.canvasHeight\r\n\t\t\t\t\t\t\titem.distanceX = item.distanceX||100\r\n\t\t\t\t\t\t\titem.distanceY = item.distanceY||50\r\n\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\tfor(let i = item.x; i<item.repeatWidth; i+=item.distanceX) {\r\n\t\t\t\t\t\t\t\tfor(let j = item.y; j<item.repeatHeight; j+=item.distanceY) {\r\n\t\t\t\t\t\t\t\t  // 填充文字，x 间距, y 间距\r\n\t\t\t\t\t\t\t\t  console.log(item.x,item.y);\r\n\t\t\t\t\t\t\t\t  ctx.fillText(item.content, i, j)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\tctx.fillText(item.content, item.x, item.y);\r\n\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif(imageArr.length){\r\n\t\t\t\t\t\timageArr.some(function(item, index) {\r\n\t\t\t\t\t\t\tconst reimg = new Image()\r\n\t\t\t\t\t\t\treimg.src = item.path\r\n\t\t\t\t\t\t\treimg.crossOrigin = 'anonymous'\r\n\t\t\t\t\t\t\treimg.onload = function() {\r\n\t\t\t\t\t\t\t\tlet rotate = item.rotate||0\r\n\t\t\t\t\t\t\t\titem.x = item.x||0\r\n\t\t\t\t\t\t\t\titem.y = item.y||0\r\n\t\t\t\t\t\t\t\titem.width = item.width||reimg.width\r\n\t\t\t\t\t\t\t\titem.height = item.height||reimg.height\r\n\t\t\t\t\t\t\t\tif(item.isRepeat){\r\n\t\t\t\t\t\t\t\t\titem.repeatWidth = item.repeatWidth||_this.canvasWidth\r\n\t\t\t\t\t\t\t\t\titem.repeatHeight = item.repeatHeight||_this.canvasHeight\r\n\t\t\t\t\t\t\t\t\titem.distanceX = item.distanceX||100\r\n\t\t\t\t\t\t\t\t\titem.distanceY = item.distanceY||50\r\n\t\t\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\tfor(let i = item.x; i<item.repeatWidth; i+=item.distanceX) {\r\n\t\t\t\t\t\t\t\t\t\tfor(let j = item.y; j<item.repeatHeight; j+=item.distanceY) {\r\n\t\t\t\t\t\t\t\t\t\t  // 填充文字，x 间距, y 间距\r\n\t\t\t\t\t\t\t\t\t\t  console.log(item.x,item.y);\r\n\t\t\t\t\t\t\t\t\t\t  ctx.drawImage(reimg, i, j, item.width, item.height)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tctx.rotate(-rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\t\t\tctx.drawImage(reimg, item.x, item.y, item.width, item.height)\r\n\t\t\t\t\t\t\t\t\tctx.rotate(rotate * Math.PI / 180)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (imageArr.length == index + 1 || textArr.length == index + 1) {\r\n\t\t\t\t\t\t\t\t\tconst base64Url = canvas.toDataURL()\r\n\t\t\t\t\t\t\t\t\t_this.$emit(\"pBackImage\", base64Url,_this.type);\r\n\t\t\t\t\t\t\t\t\t_this.fn(base64Url,_this.type)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tconst base64Url = canvas.toDataURL()\r\n\t\t\t\t\t\t_this.$emit(\"pBackImage\", base64Url,_this.type);\r\n\t\t\t\t\t\t_this.fn(base64Url,_this.type)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.content {\r\n\t\twidth: 0;\r\n\t\theight: 0;\r\n\t\toverflow: hidden;\r\n\t}\r\n</style>\r\n","import mod from \"-!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=cf1b06a2&lang=scss&scoped=true&\"; export default mod; export * from \"-!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Liberty\\\\Downloads\\\\HBuilderX.3.6.5.20221121\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=cf1b06a2&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1670488145685\n      var cssReload = require(\"C:/Users/Liberty/Downloads/HBuilderX.3.6.5.20221121/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}